[
    {
        "name": "ObeliskWait",
        "trigger": "unit_wait",
        "level_nid": "1",
        "condition": "region.nid == \"ObeliskWait\" and v(\"canEscape\") == False and unit.team == \"player\"",
        "commands": [],
        "only_once": false,
        "priority": 20,
        "_source": [
            "add_portrait;{unit};Left",
            "if;unit.nid == \"Zeke\"",
            "    speak;Zeke;A weird looking book on a weird looking obelisk{tgm}...{tgm} this must be Sky's tome.",
            "elif;unit.nid == \"Roland\"",
            "    speak;Roland;Eh? What's this weird book doing here? Is this the thing we were looking for?",
            "elif;unit.nid == \"Isabella\"",
            "    speak;Isabella;Hm? O-oh! It's a book! This must be the tome we were looking for!",
            "elif;unit.nid == \"Lex\"",
            "    speak;Lex;What an odd obelisk. Hm? A book? Ah, this must be the tome Sky was looking for.",
            "elif;unit.nid == \"Sky\"",
            "    speak;Sky;Hm? This tome{tgm}...{tgm} Ah! T-t-this is it! This is Alkahest!",
            "else;",
            "    speak;Luna;Oh great. This must be the tome we were looking for. Of course I'm the one who found it.",
            "    end",
            "",
            "remove_portrait;{unit}",
            "choice;takeAlkahest;Take the tome from the obelisk?;Take it,Leave it",
            "if;'{v:_last_choice}' == 'Leave the tome'",
            "    add_portrait;{unit};Left",
            "    speak;{unit};Hmm{tgm}...{tgm} I'll leave the tome here, for now.",
            "else;",
            "    add_portrait;{unit};Left",
            "    speak;{unit};I'll be taking this.",
            "    bop_portrait;{unit}",
            "    remove_portrait;{unit}",
            "    music_clear",
            "    wait;300",
            "    screen_shake;0",
            "    add_group;EscapeReinforcements;EscapeReinforcements;immediate;closest",
            "    music;Pokemon Conquest Boss",
            "    change_music;player_phase;Pokemon Conquest Boss",
            "    change_music;enemy_phase;Pokemon Conquest Boss",
            "    wait;1000",
            "    sound;Wall Attack",
            "    show_layer;mainDoor;fade",
            "    screen_shake_end",
            "    disp_cursor;false",
            "    move_cursor;Zeke",
            "    flicker_cursor;Zeke",
            "    add_portrait;Zeke;Left",
            "    speak;Zeke;Everyone! The crypt is getting swarmed! We have to get out, now!",
            "    remove_portrait;Zeke",
            "    wait;100",
            "    center_cursor;13,0",
            "    flicker_cursor;12,0",
            "    flicker_cursor;13,0",
            "    flicker_cursor;14,0",
            "    level_var;canEscape;True",
            "    level_var;escapeCounter;0",
            "    speak;;To escape, move a unit to one of these tiles and press \"Escape\".;;;hint;;;;;3",
            "    speak;;As long as both Zeke and Sky escape, the chapter will be won.;;;hint;;;;;3",
            "    center_cursor;{unit}",
            "    change_objective_simple; Escape ",
            "    change_objective_win;Escape from the tomb  ",
            "    end"
        ],
        "nid": "1 ObeliskWait"
    }
]